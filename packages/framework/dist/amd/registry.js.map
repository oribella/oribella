{"version":3,"sources":["../../src/registry.js"],"names":[],"mappings":";;;;;;;;;;;;;MAAa;AACX,aADW,MACX,CAAY,GAAZ,EAAiB;4BADN,QACM;;AACf,WAAK,GAAL,GAAW,GAAX,CADe;KAAjB;;AADW,qBAIX,yBAAO,GAAG;AACR,WAAK,GAAL,CAAS,OAAT,CAAiB,eAAO;AACtB,YAAI,OAAO,EAAE,GAAF,CAAP,KAAkB,UAAlB,EAA8B;AAChC,YAAE,GAAF,IAAS,YAAW,EAAX,CADuB;SAAlC;OADe,CAAjB,CADQ;;;WAJC;;;AAab,MAAM,wBAAwB;AAC5B,aAAS,CAAT;AACA,WAAO,CAAP;AACA,UAAM,GAAN;GAHI;;AAMN,WAAS,yBAAT,GAA6C;QAAV,4DAAM,kBAAI;;AAC3C,QAAM,cAAc,EAAd,CADqC;AAE3C,WAAO,IAAP,CAAY,GAAZ,EAAiB,OAAjB,CAAyB,eAAO;AAC9B,kBAAY,GAAZ,IAAmB,OAAO,wBAAP,CAAgC,GAAhC,EAAqC,GAArC,CAAnB,CAD8B;KAAP,CAAzB,CAF2C;AAK3C,WAAO,WAAP,CAL2C;GAA7C;;MAQa;AACX,aADW,QACX,GAAc;4BADH,UACG;;AACZ,WAAK,QAAL,GAAgB,EAAhB,CADY;AAEZ,WAAK,cAAL,GAAsB,IAAI,MAAJ,CAAW,CAAC,OAAD,EAAU,QAAV,EAAoB,KAApB,EAA2B,QAA3B,EAAqC,MAArC,EAA6C,QAA7C,CAAX,CAAtB,CAFY;AAGZ,WAAK,iBAAL,GAAyB,IAAI,MAAJ,CAAW,CAAC,MAAD,EAAS,OAAT,EAAkB,QAAlB,EAA4B,KAA5B,EAAmC,QAAnC,CAAX,CAAzB,CAHY;KAAd;;AADW,uBAMX,6BAAS,MAAM,SAAS;AACtB,WAAK,cAAL,CAAoB,MAApB,CAA2B,QAAQ,SAAR,CAA3B,CADsB;AAEtB,WAAK,QAAL,CAAc,IAAd,IAAsB,OAAtB,CAFsB;;;AANb,uBAUX,+BAAW;AACT,aAAO,OAAO,IAAP,CAAY,KAAK,QAAL,CAAnB,CADS;;;AAVA,uBAaX,yBAAO,MAAM,YAAY,SAAS;AAChC,UAAI,iBAAiB,IAAjB,CAD4B;AAEhC,UAAI,oCAAoC,EAApC,CAF4B;AAGhC,WAAK,iBAAL,CAAuB,MAAvB,CAA8B,UAA9B,EAHgC;AAIhC,UAAI,OAAO,KAAK,QAAL,CAAc,IAAd,EAAoB,cAApB,KAAuC,UAA9C,EAA0D;AAC5D,yBAAiB,KAAK,QAAL,CAAc,IAAd,EAAoB,cAApB,EAAjB,CAD4D;AAE5D,4CAAoC,0BAA0B,cAA1B,CAApC,CAF4D;OAA9D;AAIA,uBAAiB,OAAO,MAAP,CAAc,qBAAd,EAAqC,iCAArC,CAAjB,CARgC;AAShC,UAAM,6BAA6B,0BAA0B,WAAW,OAAX,CAAvD,CAT0B;AAUhC,iBAAW,OAAX,GAAqB,OAAO,MAAP,CAAc,cAAd,EAA8B,0BAA9B,CAArB,CAVgC;AAWhC,UAAI,UAAU,IAAI,KAAK,QAAL,CAAc,IAAd,CAAJ,CAAwB,UAAxB,EAAoC,OAApC,CAAV,CAX4B;AAYhC,aAAO,OAAP,CAZgC;;;WAbvB","file":"registry.js","sourcesContent":["export class Ensure {\n  constructor(fns) {\n    this.fns = fns;\n  }\n  ensure(o) {\n    this.fns.forEach(key => {\n      if (typeof o[key] !== \"function\") {\n        o[key] = function() {};\n      }\n    });\n  }\n}\n\nconst DefaultGestureOptions = {\n  touches: 1,\n  which: 1,\n  prio: 100\n};\n\nfunction getOwnPropertyDescriptors(src = {}) {\n  const descriptors = {};\n  Object.keys(src).forEach(key => {\n    descriptors[key] = Object.getOwnPropertyDescriptor(src, key);\n  } );\n  return descriptors;\n}\n\nexport class Registry {\n  constructor() {\n    this.gestures = {};\n    this.defaultGesture = new Ensure([\"start\", \"update\", \"end\", \"cancel\", \"bind\", \"unbind\"]);\n    this.defaultSubscriber = new Ensure([\"down\", \"start\", \"update\", \"end\", \"cancel\"]);\n  }\n  register(type, Gesture) {\n    this.defaultGesture.ensure(Gesture.prototype);\n    this.gestures[type] = Gesture;\n  }\n  getTypes() {\n    return Object.keys(this.gestures);\n  }\n  create(type, subscriber, element) {\n    let defaultOptions = null;\n    let defaultOptionsPropertyDescriptors = {};\n    this.defaultSubscriber.ensure(subscriber);\n    if (typeof this.gestures[type].defaultOptions === \"function\") {\n      defaultOptions = this.gestures[type].defaultOptions();\n      defaultOptionsPropertyDescriptors = getOwnPropertyDescriptors(defaultOptions);\n    }\n    defaultOptions = Object.create(DefaultGestureOptions, defaultOptionsPropertyDescriptors);\n    const optionsPropertyDescriptors = getOwnPropertyDescriptors(subscriber.options);\n    subscriber.options = Object.create(defaultOptions, optionsPropertyDescriptors);\n    let gesture = new this.gestures[type](subscriber, element);\n    return gesture;\n  }\n}\n"]}