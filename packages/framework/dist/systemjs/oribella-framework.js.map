{"version":3,"sources":["../../src/engine.js","../../src/flows/flow.js","../../src/flows/mouse.js","../../src/flows/ms-pointer.js","../../src/flows/pointer.js","../../src/flows/touch.js","../../src/handle.js","../../src/index.js","../../src/oribella.js","../../src/point.js","../../src/registry.js","../../src/utils.js"],"names":[],"mappings":"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","file":"oribella-framework.js","sourcesContent":["/*eslint no-cond-assign: 0*/\nimport {Handle} from \"./handle\";\nimport {GESTURE_STARTED, STRATEGY_FLAG, RETURN_FLAG, matchesSelector} from \"./utils\";\n\nvar POINTERS = \"__pointers__\";\n\nexport var ACTION_START = \"start\",\n  ACTION_UPDATE = \"update\",\n  ACTION_END = \"end\",\n  ACTION_CANCEL = \"cancel\";\n\nexport class Engine {\n  constructor(element, registry, isMouse, isValidMouseButton) {\n    this.element = element;\n    this.registry = registry;\n    this.isMouse = isMouse;\n    this.isValidMouseButton = isValidMouseButton;\n    this.flows = [];\n    this.activeFlow = null;\n    this.handles = [];\n    this.gestures = [];\n    this.composedGestures = [];\n  }\n  registerGesture(type, Gesture) {\n    this.registry.register(type, Gesture);\n  }\n  activate() {\n    var stopListeners = [];\n    this.flows.forEach(flow => {\n      stopListeners.push(flow.activate());\n    });\n    return () => {\n      stopListeners.forEach(stop => stop());\n    };\n  }\n  addHandle(element, type, subscriber) {\n    var handle = new Handle(element, type, subscriber);\n\n    this.handles.push(handle);\n\n    return () => {\n      var ix = this.handles.indexOf(handle);\n      if (ix !== -1) {\n        this.handles.splice(ix, 1);\n      }\n    };\n  }\n  addFlow(flow) {\n    this.flows.push(flow);\n    flow.onStart(this.startFlow.bind(this))\n      .onUpdate(this.updateFlow.bind(this))\n      .onCancel(this.cancelFlow.bind(this))\n      .onEnd(this.endFlow.bind(this))\n      .onStop(this.stopFlow.bind(this));\n    return flow;\n  }\n  canActivateFlow(flow) {\n    return (this.activeFlow === null || this.activeFlow === flow);\n  }\n  startFlow(flow, event, allPointers, currentPointers) {\n    if (!this.canActivateFlow(flow)) {\n      return false;\n    }\n\n    this.activeFlow = flow;\n\n    this.gestures = this.gestures\n                      .concat(this.match(event.target))\n                      .sort( (g1, g2) => {\n                        return g1.subscriber.options.prio -\n                          g2.subscriber.options.prio;\n                      });\n\n    if (!this.gestures.length) {\n      return false; //No match don't continue\n    }\n\n    this.processEvent(flow, event, allPointers, currentPointers, ACTION_START);\n\n    return true;\n  }\n  updateFlow(flow, event, allPointers, currentPointers) {\n    this.processEvent(flow, event, allPointers, currentPointers, ACTION_UPDATE);\n  }\n  cancelFlow(flow, event, allPointers, currentPointers) {\n    this.processEvent(flow, event, allPointers, currentPointers, ACTION_CANCEL);\n  }\n  endFlow(flow, event, allPointers, currentPointers) {\n    this.processEvent(flow, event, allPointers, currentPointers, ACTION_END);\n  }\n  stopFlow() {\n    let gestures = this.gestures.slice(),\n      gesture,\n      result;\n\n    while (gesture = gestures.shift()) {\n      result = gesture.unbind();\n      if (result === false) {\n        this.composedGestures.push(gesture);\n      }\n    }\n\n    this.gestures.length = 0;\n    this.activeFlow = null;\n  }\n  removeGesture(gesture, ...arr) {\n    if (gesture[GESTURE_STARTED]) {\n      gesture[ACTION_CANCEL]();\n    }\n    gesture.unbind();\n    let gestures;\n    while (gestures = arr.shift()) {\n      let ix = gestures.indexOf(gesture);\n      if (ix !== -1) {\n        gestures.splice(ix, 1);\n      }\n    }\n  }\n  processEvent(flow, event, allPointers, currentPointers, action) {\n    if (this.activeFlow !== flow) {\n      return;\n    }\n    this.processGestures(event, allPointers, currentPointers, action);\n  }\n  getPointersDelta(event, pointerCount, options) {\n    if (this.isMouse(event) && !this.isValidMouseButton(event, options.which)) {\n      return -1;\n    }\n    return pointerCount - options.touches;\n  }\n  processGestures(event, allPointers, currentPointers, action) {\n    let gestures = this.gestures.slice(),\n      gesture,\n      result,\n      allResult,\n      allPointerCnt = Object.keys(allPointers).length,\n      currentPointerIds = Object.keys(currentPointers),\n      currentPointerCnt = currentPointerIds.length,\n      pointerIx,\n      pointerId,\n      pointerIds,\n      pointerCnt,\n      pointers,\n      hasPointer,\n      removePointers,\n      removeGesture,\n      options;\n\n    while (gesture = gestures.shift()) {\n      hasPointer = false;\n      removePointers = false;\n      removeGesture = false;\n      pointers = gesture[POINTERS];\n      options = gesture.subscriber.options;\n\n      allResult = this.getPointersDelta(event, allPointerCnt, options);\n      if (allResult > 0 && options.strategy & STRATEGY_FLAG.REMOVE_IF_POINTERS_GT){\n        this.removeGesture(gesture, this.gestures, this.composedGestures, gestures);\n        continue;\n      }\n\n      result = this.getPointersDelta(event, currentPointerCnt, options);\n      switch (action) {\n        case ACTION_START:\n          if (result !== 0) {\n            if (allResult === 0) {\n              currentPointers = allPointers;\n            } else {\n              continue;\n            }\n          }\n          if (pointers && Object.keys(pointers).length === currentPointerCnt) {\n            continue;\n          }\n          //Lock pointers for gesture\n          gesture[POINTERS] = pointers = currentPointers;\n          hasPointer = true;\n          break;\n        case ACTION_UPDATE:\n          //Update pointers for gesture\n          pointerIx = 0;\n          while (pointerIx < currentPointerCnt) {\n            pointerId = currentPointerIds[pointerIx];\n            if (pointers && pointers[pointerId]) {\n              pointers[pointerId] = currentPointers[pointerId];\n              hasPointer = true;\n            }\n            ++pointerIx;\n          }\n          break;\n        case ACTION_END:\n          if (!gesture[GESTURE_STARTED]){\n            continue;\n          }\n          pointerIx = 0;\n          while (pointerIx < currentPointerCnt) {\n            pointerId = currentPointerIds[pointerIx];\n            if (pointers && pointers[pointerId]) {\n              hasPointer = true;\n              removePointers = true;\n            }\n            ++pointerIx;\n          }\n          if (pointers && !Object.keys(pointers).length) {\n            hasPointer = true;\n            removeGesture = true;\n          }\n          break;\n        case ACTION_CANCEL:\n          pointers = currentPointers;\n          hasPointer = true;\n          break;\n      }\n      if (!hasPointer) {\n        continue;\n      }\n      //Map pointers to separate object reference\n      const mappedPointers = [];\n      pointerIx = 0;\n      pointerIds = Object.keys(pointers);\n      pointerCnt = pointerIds.length;\n      while (pointerIx < pointerCnt) {\n        mappedPointers.push(pointers[pointerIds[pointerIx]]);\n        ++pointerIx;\n      }\n      this.processGesture(event, mappedPointers, action, gesture, gestures);\n\n      if (removePointers) {\n        pointerIx = 0;\n        while (pointerIx < currentPointerCnt) {\n          pointerId = currentPointerIds[pointerIx];\n          if (pointers[pointerId]) {\n            delete pointers[pointerId];\n          }\n          ++pointerIx;\n        }\n      }\n\n      if (removeGesture) {\n        gesture[POINTERS] = null;\n        gesture[GESTURE_STARTED] = false;\n        this.removeGesture(gesture, this.gestures, this.composedGestures, gestures);\n      }\n    }\n  }\n  processGesture(event, pointers, action, gesture, gestures) {\n    //Call\n    let result = gesture[action](event, pointers);\n    if (result & RETURN_FLAG.STARTED) {\n      gesture[GESTURE_STARTED] = true;\n    }\n\n    //Remove gesture\n    if (result & RETURN_FLAG.REMOVE) {\n      this.removeGesture(gesture, this.gestures, this.composedGestures, gestures);\n    }\n\n    //Remove all other gestures\n    if (result & RETURN_FLAG.REMOVE_OTHERS) {\n      let otherGestures = gestures.slice();\n      let otherGesture;\n      while (otherGesture = otherGestures.shift()) {\n        if (gesture === otherGesture) {\n          continue;\n        }\n        if (otherGesture[GESTURE_STARTED]) {\n          otherGesture[ACTION_CANCEL]();\n        }\n        this.removeGesture(otherGesture, this.gestures, this.composedGestures, gestures);\n      }\n    }\n  }\n  createGesture(handle, element) {\n    var gesture = this.registry.create(handle.type, handle.subscriber, element);\n    gesture.bind(this.addHandle.bind(this), handle.element, this.removeGesture.bind(this, gesture, this.gestures, this.composedGestures), () => { gesture[GESTURE_STARTED] = true; });\n    return gesture;\n  }\n  match(startElement) {\n    let i,\n      handle,\n      element,\n      selector,\n      gesture,\n      gestures = [],\n      matched = false;\n\n    for (element = startElement; element !== this.element; element = element.parentNode) {\n      for (i = 0; i < this.handles.length; ++i) { //Always evaluate length since gestures could bind gestures\n        handle = this.handles[i];\n        selector = handle.subscriber.selector;\n\n        if (!handle.element.contains(element) || (selector && handle.element === element)) {\n          continue;\n        }\n\n        if (!selector && element === handle.element) {\n          matched = true;\n        } else if (selector) {\n          if (matchesSelector(element, selector)) {\n            matched = true;\n          }\n        }\n        if (matched) {\n          while (gesture = this.composedGestures.shift()) {\n            if (gesture.subscriber === handle.subscriber) {\n              break;\n            }\n          }\n          if (!gesture) {\n            gesture = this.createGesture(handle, element);\n          }\n          gestures.push(gesture);\n        }\n      }\n    }\n\n    return gestures;\n  }\n}\n","/*eslint no-cond-assign: 0*/\n\nfunction removeListener(element, event, fn) {\n  element.removeEventListener(event, fn, false);\n}\n\nfunction addListener(element, event, fn) {\n  element.addEventListener(event, fn, false);\n  return removeListener.bind(null, element, event, fn);\n}\n\nexport class Flow {\n  constructor(element, Point, events, stopEmulatedMouseEvents) {\n    this.element = element;\n    this.Point = Point;\n    this.events = events;\n    this.stopEmulatedMouseEvents = stopEmulatedMouseEvents;\n    this.addListeners = [];\n    this.removeListeners = [];\n    this.allPointers = {};\n    this.currentPointers = {};\n    this.init();\n  }\n  init() {\n    var event,\n      key,\n      types,\n      type,\n      fn;\n\n    while (event = this.events.shift()) {\n      key = Object.keys(event).shift();\n      types = event[key];\n      fn = this[key].bind(this);\n\n      if (key === \"start\") {\n        this.startListener = addListener.bind(null, this.element, types.shift(), fn);\n      } else {\n        while (type = types.shift()) {\n          this.addListeners.push(addListener.bind(null, this.element, type, fn));\n        }\n      }\n    }\n  }\n  normalizePoints(/*event, data, Point*/) {\n    throw new Error(\"normalizePoints: must be implemented in sub class\");\n  }\n  onStart(startCallback) {\n    this.startCallback = startCallback;\n    return this;\n  }\n  onUpdate(updateCallback) {\n    this.updateCallback = updateCallback;\n    return this;\n  }\n  onCancel(cancelCallback) {\n    this.cancelCallback = cancelCallback;\n    return this;\n  }\n  onEnd(endCallback) {\n    this.endCallback = endCallback;\n    return this;\n  }\n  onStop(stopCallback) {\n    this.stopCallback = stopCallback;\n  }\n  activate() {\n    return this.startListener();\n  }\n  start(event) {\n    this.normalizePoints(event, this.Point);\n    if (this.startCallback(this, event, this.allPointers, this.currentPointers)) {\n      this.continue();\n    }\n  }\n  continue() {\n    var i,\n      cnt = this.addListeners.length;\n\n    for (i = 0; i < cnt; ++i) {\n      this.removeListeners.push(this.addListeners[i]());\n    }\n  }\n  update(event) {\n    this.normalizePoints(event, this.Point);\n    this.updateCallback(this, event, this.allPointers, this.currentPointers);\n  }\n  end(event) {\n    this.normalizePoints(event, this.Point);\n    this.endCallback(this, event, this.allPointers, this.currentPointers);\n    if (Object.keys(this.allPointers).length === 0) {\n      this.stop();\n    }\n  }\n  cancel(event) {\n    this.cancelCallback(this, event, this.allPointers, this.currentPointers);\n    this.stop();\n  }\n  stop() {\n    var i,\n      cnt = this.removeListeners.length;\n\n    for (i = 0; i < cnt; ++i) {\n      this.removeListeners[i]();\n    }\n    this.removeListeners.length = 0;\n    this.stopCallback(this);\n  }\n}\n","import {Flow} from \"./flow\";\n\nexport class MouseFlow extends Flow {\n  constructor(element, Point) {\n    super(element, Point, [{\n      start: [\"mousedown\"]\n    }, {\n      update: [\"mousemove\"]\n    }, {\n      end: [\"mouseup\"]\n    }, {\n      cancel: [\"dragstart\", \"contextmenu\"]\n    }], false);\n  }\n  normalizePoints(event, Point) {\n    switch (event.type) {\n      case \"mousedown\":\n      case \"mousemove\":\n        this.allPointers = this.currentPointers = {\n          1: {\n            page: new Point(event.pageX, event.pageY),\n            client: new Point(event.clientX, event.clientY)\n          }\n        };\n        break;\n      default:\n        this.allPointers = {};\n        break;\n    }\n  }\n}\n","import {PointerFlow} from \"./pointer\";\n\nexport class MSPointerFlow extends PointerFlow {\n  constructor(element, Point) {\n    super(element, Point, [{\n      start: [\"MSPointerDown\"]\n    }, {\n      update: [\"MSPointerMove\"]\n    }, {\n      end: [\"MSPointerUp\"]\n    }, {\n      cancel: [\"MSPointerCancel\", \"dragstart\"]\n    }]);\n  }\n}\n","import {Flow} from \"./flow\";\n\nexport class PointerFlow extends Flow {\n  constructor(element, Point) {\n    super(element, Point, [{\n      start: [\"pointerdown\"]\n    }, {\n      update: [\"pointermove\"]\n    }, {\n      end: [\"pointerup\"]\n    }, {\n      cancel: [\"pointercancel\", \"dragstart\"]\n    }]);\n  }\n  normalizePoints(event, Point) {\n    this.currentPointers = {};\n    this.currentPointers[event.pointerId] = {\n      page: new Point(event.pageX, event.pageY),\n      client: new Point(event.clientX, event.clientY)\n    };\n\n    switch (event.type) {\n      case \"pointerdown\":\n      case \"pointermove\":\n        this.allPointers[event.pointerId] = {\n          page: new Point(event.pageX, event.pageY),\n          client: new Point(event.clientX, event.clientY)\n        };\n        break;\n      default:\n        delete this.allPointers[event.pointerId];\n        break;\n    }\n  }\n}\n","import {Flow} from \"./flow\";\n\nexport class TouchFlow extends Flow {\n  constructor(element, Point) {\n    super(element, Point, [{\n      start: [\"touchstart\"]\n    }, {\n      update: [\"touchmove\"]\n    }, {\n      end: [\"touchend\", \"mouseup\", \"click\"]\n    }, {\n      cancel: [\"touchcancel\", \"dragstart\"]\n    }], true);\n  }\n  normalizePoints(event, Point) {\n    this.allPointers = {};\n    this.currentPointers = {};\n\n    Array.prototype.slice.call(event.touches).forEach(pointer => {\n      this.allPointers[pointer.identifier] = {\n        page: new Point(pointer.pageX, pointer.pageY),\n        client: new Point(pointer.clientX, pointer.clientY)\n      };\n    });\n\n    Array.prototype.slice.call(event.changedTouches).forEach(pointer => {\n      this.currentPointers[pointer.identifier] = {\n        page: new Point(pointer.pageX, pointer.pageY),\n        client: new Point(pointer.clientX, pointer.clientY)\n      };\n    });\n\n  }\n}\n","export class Handle {\n  constructor(element, type, subscriber, active) {\n    this.element = element;\n    this.type = type;\n    this.subscriber = subscriber;\n    this.active = active;\n  }\n}\n","export {Point} from \"./point\";\nexport {GESTURE_STARTED, STRATEGY_FLAG, RETURN_FLAG, matchesSelector} from \"./utils\";\nexport {Oribella} from \"./oribella\";\n","import {Engine} from \"./engine\";\nimport {Registry} from \"./registry\";\nimport {MouseFlow} from \"./flows/mouse\";\nimport {TouchFlow} from \"./flows/touch\";\nimport {MSPointerFlow} from \"./flows/ms-pointer\";\nimport {PointerFlow} from \"./flows/pointer\";\nimport {Point} from \"./point\";\n\nexport class Oribella {\n  constructor(element, config) {\n    this.element = element;\n    this.config = config;\n    this.registry = new Registry();\n    this.engine = new Engine(this.element,\n      this.registry,\n      this.isMouse.bind(this),\n      this.isValidMouseButton.bind(this)\n    );\n  }\n  activate() {\n    return this.engine.activate();\n  }\n  withDefaultFlowStrategy() {\n    if (this.config.msPointerEnabled) {\n      this.engine.addFlow(new MSPointerFlow(this.element, Point));\n      return this;\n    }\n    if (this.config.pointerEnabled) {\n      this.engine.addFlow(new PointerFlow(this.element, Point));\n      return this;\n    }\n\n    if (this.config.touchEnabled) {\n      this.engine.addFlow(new TouchFlow(this.element, Point));\n    }\n\n    this.engine.addFlow(new MouseFlow(this.element, Point));\n    return this;\n  }\n  registerGesture(type, Gesture) {\n    this.engine.registerGesture(type, Gesture);\n    return this;\n  }\n  on(element, type, subscriber) {\n    return this.engine.addHandle(element, type, subscriber);\n  }\n  isMouse(e) {\n    if (this.config.msPointerEnabled && e.pointerType === e.MSPOINTER_TYPE_MOUSE) { //IE10\n      return true;\n    }\n    if (this.config.pointerEnabled && e.pointerType === \"mouse\") { //IE11\n      return true;\n    }\n    if (e.type.indexOf(\"mouse\") !== -1) {\n      return true;\n    }\n    return false;\n  }\n  isValidMouseButton(event, allowedBtn) {\n    var btn = event.button,\n      which = event.which,\n      actualBtn;\n\n    actualBtn = (!which && btn !== undefined) ?\n                  (btn & 1 ? 1 : (btn & 2 ? 3 : (btn & 4 ? 2 : 0))) :\n                  which;\n    return Array.isArray(allowedBtn) ? allowedBtn.some(function (val) {\n      return actualBtn === val;\n    }) : actualBtn === allowedBtn;\n  }\n}\n","export class Point {\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n  distanceTo(p) {\n    var xdist = this.x - p.x,\n      ydist = this.y - p.y,\n      dist = Math.sqrt(xdist * xdist + ydist * ydist);\n\n    return dist;\n  }\n  deltaAngleTo(p) {\n    var x = p.x - this.x,\n      y = p.y - this.y,\n      theta = Math.atan2(y, x),\n      degrees = theta * 180 / Math.PI;\n    return degrees;\n  }\n  clone() {\n    return new Point(this.x, this.y);\n  }\n}\n","export class Ensure {\n  constructor(fns) {\n    this.fns = fns;\n  }\n  ensure(o) {\n    this.fns.forEach(key => {\n      if (typeof o[key] !== \"function\") {\n        o[key] = function() {};\n      }\n    });\n  }\n}\n\nconst DefaultGestureOptions = {\n  touches: 1,\n  which: 1,\n  prio: 100\n};\n\nfunction getOwnPropertyDescriptors(src) {\n  const descriptors = {};\n  Object.getOwnPropertyNames(src).forEach(key => {\n    descriptors[key] = Object.getOwnPropertyDescriptor(src, key);\n  } );\n  return descriptors;\n}\n\nexport class Registry {\n  constructor() {\n    this.gestures = {};\n    this.defaultGesture = new Ensure([\"start\", \"update\", \"end\", \"cancel\", \"bind\", \"unbind\"]);\n    this.defaultSubscriber = new Ensure([\"down\", \"start\", \"update\", \"end\", \"cancel\"]);\n  }\n  register(type, Gesture) {\n    this.defaultGesture.ensure(Gesture.prototype);\n    this.gestures[type] = Gesture;\n  }\n  getTypes() {\n    return Object.keys(this.gestures);\n  }\n  create(type, subscriber, element) {\n    let defaultOptions = null;\n    let defaultOptionsPropertyDescriptors = {};\n    this.defaultSubscriber.ensure(subscriber);\n    if (typeof this.gestures[type].defaultOptions === \"function\") {\n      defaultOptions = this.gestures[type].defaultOptions();\n      defaultOptionsPropertyDescriptors = getOwnPropertyDescriptors(defaultOptions);\n    }\n    defaultOptions = Object.create(DefaultGestureOptions, defaultOptionsPropertyDescriptors);\n    const optionsPropertyDescriptors = getOwnPropertyDescriptors(subscriber.options);\n    subscriber.options = Object.create(defaultOptions, optionsPropertyDescriptors);\n    let gesture = new this.gestures[type](subscriber, element);\n    return gesture;\n  }\n}\n","export const GESTURE_STARTED = \"__started__\";\n\nexport const STRATEGY_FLAG = {\n  REMOVE_IF_POINTERS_GT: 1\n};\n\nexport const RETURN_FLAG = {\n  map(result) {\n    switch (result) {\n    case true:\n      result = this.REMOVE_OTHERS;\n      break;\n    case false:\n      result = this.REMOVE;\n      break;\n    case 1:\n    case 2:\n    case 4:\n      break;\n    default:\n      result = 0;\n    }\n\n    return result;\n  },\n  STARTED: 1,\n  REMOVE: 2,\n  REMOVE_OTHERS: 4\n};\n\nexport function matchesSelector(element, selector) {\n  return (element.matchesSelector ||\n    element.webkitMatchesSelector ||\n    element.mozMatchesSelector ||\n    element.msMatchesSelector ||\n    element.oMatchesSelector\n  ).call(element, selector);\n}\n"]}