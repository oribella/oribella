{"version":3,"sources":["../../src/registry.js"],"names":[],"mappings":";;;;;;;;;;;AAmBA,WAAS,yBAAT,GAA6C;QAAV,4DAAM,kBAAI;;AAC3C,QAAM,cAAc,EAAd,CADqC;AAE3C,WAAO,IAAP,CAAY,GAAZ,EAAiB,OAAjB,CAAyB,eAAO;AAC9B,kBAAY,GAAZ,IAAmB,OAAO,wBAAP,CAAgC,GAAhC,EAAqC,GAArC,CAAnB,CAD8B;KAAP,CAAzB,CAF2C;AAK3C,WAAO,WAAP,CAL2C;GAA7C;;;;;wBAnBa;AACX,iBADW,MACX,CAAY,GAAZ,EAAiB;gCADN,QACM;;AACf,eAAK,GAAL,GAAW,GAAX,CADe;SAAjB;;AADW,yBAIX,yBAAO,GAAG;AACR,eAAK,GAAL,CAAS,OAAT,CAAiB,eAAO;AACtB,gBAAI,OAAO,EAAE,GAAF,CAAP,KAAkB,UAAlB,EAA8B;AAChC,gBAAE,GAAF,IAAS,YAAW,EAAX,CADuB;aAAlC;WADe,CAAjB,CADQ;;;eAJC;;;;;AAaP,8BAAwB;AAC5B,iBAAS,CAAT;AACA,eAAO,CAAP;AACA,cAAM,GAAN;;;0BAWW;AACX,iBADW,QACX,GAAc;gCADH,UACG;;AACZ,eAAK,QAAL,GAAgB,EAAhB,CADY;AAEZ,eAAK,cAAL,GAAsB,IAAI,MAAJ,CAAW,CAAC,OAAD,EAAU,QAAV,EAAoB,KAApB,EAA2B,QAA3B,EAAqC,MAArC,EAA6C,QAA7C,CAAX,CAAtB,CAFY;AAGZ,eAAK,iBAAL,GAAyB,IAAI,MAAJ,CAAW,CAAC,MAAD,EAAS,OAAT,EAAkB,QAAlB,EAA4B,KAA5B,EAAmC,QAAnC,CAAX,CAAzB,CAHY;SAAd;;AADW,2BAMX,6BAAS,MAAM,SAAS;AACtB,eAAK,cAAL,CAAoB,MAApB,CAA2B,QAAQ,SAAR,CAA3B,CADsB;AAEtB,eAAK,QAAL,CAAc,IAAd,IAAsB,OAAtB,CAFsB;;;AANb,2BAUX,+BAAW;AACT,iBAAO,OAAO,IAAP,CAAY,KAAK,QAAL,CAAnB,CADS;;;AAVA,2BAaX,yBAAO,MAAM,YAAY,SAAS;AAChC,cAAI,iBAAiB,IAAjB,CAD4B;AAEhC,cAAI,oCAAoC,EAApC,CAF4B;AAGhC,eAAK,iBAAL,CAAuB,MAAvB,CAA8B,UAA9B,EAHgC;AAIhC,cAAI,OAAO,KAAK,QAAL,CAAc,IAAd,EAAoB,cAApB,KAAuC,UAA9C,EAA0D;AAC5D,6BAAiB,KAAK,QAAL,CAAc,IAAd,EAAoB,cAApB,EAAjB,CAD4D;AAE5D,gDAAoC,0BAA0B,cAA1B,CAApC,CAF4D;WAA9D;AAIA,2BAAiB,OAAO,MAAP,CAAc,qBAAd,EAAqC,iCAArC,CAAjB,CARgC;AAShC,cAAM,6BAA6B,0BAA0B,WAAW,OAAX,CAAvD,CAT0B;AAUhC,qBAAW,OAAX,GAAqB,OAAO,MAAP,CAAc,cAAd,EAA8B,0BAA9B,CAArB,CAVgC;AAWhC,cAAI,UAAU,IAAI,KAAK,QAAL,CAAc,IAAd,CAAJ,CAAwB,UAAxB,EAAoC,OAApC,CAAV,CAX4B;AAYhC,iBAAO,OAAP,CAZgC;;;eAbvB","file":"registry.js","sourcesContent":["export class Ensure {\n  constructor(fns) {\n    this.fns = fns;\n  }\n  ensure(o) {\n    this.fns.forEach(key => {\n      if (typeof o[key] !== \"function\") {\n        o[key] = function() {};\n      }\n    });\n  }\n}\n\nconst DefaultGestureOptions = {\n  touches: 1,\n  which: 1,\n  prio: 100\n};\n\nfunction getOwnPropertyDescriptors(src = {}) {\n  const descriptors = {};\n  Object.keys(src).forEach(key => {\n    descriptors[key] = Object.getOwnPropertyDescriptor(src, key);\n  } );\n  return descriptors;\n}\n\nexport class Registry {\n  constructor() {\n    this.gestures = {};\n    this.defaultGesture = new Ensure([\"start\", \"update\", \"end\", \"cancel\", \"bind\", \"unbind\"]);\n    this.defaultSubscriber = new Ensure([\"down\", \"start\", \"update\", \"end\", \"cancel\"]);\n  }\n  register(type, Gesture) {\n    this.defaultGesture.ensure(Gesture.prototype);\n    this.gestures[type] = Gesture;\n  }\n  getTypes() {\n    return Object.keys(this.gestures);\n  }\n  create(type, subscriber, element) {\n    let defaultOptions = null;\n    let defaultOptionsPropertyDescriptors = {};\n    this.defaultSubscriber.ensure(subscriber);\n    if (typeof this.gestures[type].defaultOptions === \"function\") {\n      defaultOptions = this.gestures[type].defaultOptions();\n      defaultOptionsPropertyDescriptors = getOwnPropertyDescriptors(defaultOptions);\n    }\n    defaultOptions = Object.create(DefaultGestureOptions, defaultOptionsPropertyDescriptors);\n    const optionsPropertyDescriptors = getOwnPropertyDescriptors(subscriber.options);\n    subscriber.options = Object.create(defaultOptions, optionsPropertyDescriptors);\n    let gesture = new this.gestures[type](subscriber, element);\n    return gesture;\n  }\n}\n"]}