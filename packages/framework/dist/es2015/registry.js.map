{"version":3,"sources":["../../src/registry.js"],"names":[],"mappings":"AAAA,WAAa,SAAN,MAAM,MAAN,CAAa;AAClB,cAAY,GAAZ,EAAiB;AACf,SAAK,GAAL,GAAW,GAAX,CADe;GAAjB;AAGA,SAAO,CAAP,EAAU;AACR,SAAK,GAAL,CAAS,OAAT,CAAiB,OAAO;AACtB,UAAI,OAAO,EAAE,GAAF,CAAP,KAAkB,UAAlB,EAA8B;AAChC,UAAE,GAAF,IAAS,YAAW,EAAX,CADuB;OAAlC;KADe,CAAjB,CADQ;GAAV;CAJK,CAAP;;AAaA,MAAM,wBAAwB;AAC5B,WAAS,CAAT;AACA,SAAO,CAAP;AACA,QAAM,GAAN;CAHI;;AAMN,SAAS,yBAAT,CAAmC,MAAM,EAAN,EAAU;AAC3C,QAAM,cAAc,EAAd,CADqC;AAE3C,SAAO,IAAP,CAAY,GAAZ,EAAiB,OAAjB,CAAyB,OAAO;AAC9B,gBAAY,GAAZ,IAAmB,OAAO,wBAAP,CAAgC,GAAhC,EAAqC,GAArC,CAAnB,CAD8B;GAAP,CAAzB,CAF2C;AAK3C,SAAO,WAAP,CAL2C;CAA7C;;AAQA,WAAa,WAAN,MAAM,QAAN,CAAe;AACpB,gBAAc;AACZ,SAAK,QAAL,GAAgB,EAAhB,CADY;AAEZ,SAAK,cAAL,GAAsB,IAAI,MAAJ,CAAW,CAAC,OAAD,EAAU,QAAV,EAAoB,KAApB,EAA2B,QAA3B,EAAqC,MAArC,EAA6C,QAA7C,CAAX,CAAtB,CAFY;AAGZ,SAAK,iBAAL,GAAyB,IAAI,MAAJ,CAAW,CAAC,MAAD,EAAS,OAAT,EAAkB,QAAlB,EAA4B,KAA5B,EAAmC,QAAnC,CAAX,CAAzB,CAHY;GAAd;AAKA,WAAS,IAAT,EAAe,OAAf,EAAwB;AACtB,SAAK,cAAL,CAAoB,MAApB,CAA2B,QAAQ,SAAR,CAA3B,CADsB;AAEtB,SAAK,QAAL,CAAc,IAAd,IAAsB,OAAtB,CAFsB;GAAxB;AAIA,aAAW;AACT,WAAO,OAAO,IAAP,CAAY,KAAK,QAAL,CAAnB,CADS;GAAX;AAGA,SAAO,IAAP,EAAa,UAAb,EAAyB,OAAzB,EAAkC;AAChC,QAAI,iBAAiB,IAAjB,CAD4B;AAEhC,QAAI,oCAAoC,EAApC,CAF4B;AAGhC,SAAK,iBAAL,CAAuB,MAAvB,CAA8B,UAA9B,EAHgC;AAIhC,QAAI,OAAO,KAAK,QAAL,CAAc,IAAd,EAAoB,cAApB,KAAuC,UAA9C,EAA0D;AAC5D,uBAAiB,KAAK,QAAL,CAAc,IAAd,EAAoB,cAApB,EAAjB,CAD4D;AAE5D,0CAAoC,0BAA0B,cAA1B,CAApC,CAF4D;KAA9D;AAIA,qBAAiB,OAAO,MAAP,CAAc,qBAAd,EAAqC,iCAArC,CAAjB,CARgC;AAShC,UAAM,6BAA6B,0BAA0B,WAAW,OAAX,CAAvD,CAT0B;AAUhC,eAAW,OAAX,GAAqB,OAAO,MAAP,CAAc,cAAd,EAA8B,0BAA9B,CAArB,CAVgC;AAWhC,QAAI,UAAU,IAAI,KAAK,QAAL,CAAc,IAAd,CAAJ,CAAwB,UAAxB,EAAoC,OAApC,CAAV,CAX4B;AAYhC,WAAO,OAAP,CAZgC;GAAlC;CAbK,CAAP","file":"registry.js","sourcesContent":["export class Ensure {\n  constructor(fns) {\n    this.fns = fns;\n  }\n  ensure(o) {\n    this.fns.forEach(key => {\n      if (typeof o[key] !== \"function\") {\n        o[key] = function() {};\n      }\n    });\n  }\n}\n\nconst DefaultGestureOptions = {\n  touches: 1,\n  which: 1,\n  prio: 100\n};\n\nfunction getOwnPropertyDescriptors(src = {}) {\n  const descriptors = {};\n  Object.keys(src).forEach(key => {\n    descriptors[key] = Object.getOwnPropertyDescriptor(src, key);\n  } );\n  return descriptors;\n}\n\nexport class Registry {\n  constructor() {\n    this.gestures = {};\n    this.defaultGesture = new Ensure([\"start\", \"update\", \"end\", \"cancel\", \"bind\", \"unbind\"]);\n    this.defaultSubscriber = new Ensure([\"down\", \"start\", \"update\", \"end\", \"cancel\"]);\n  }\n  register(type, Gesture) {\n    this.defaultGesture.ensure(Gesture.prototype);\n    this.gestures[type] = Gesture;\n  }\n  getTypes() {\n    return Object.keys(this.gestures);\n  }\n  create(type, subscriber, element) {\n    let defaultOptions = null;\n    let defaultOptionsPropertyDescriptors = {};\n    this.defaultSubscriber.ensure(subscriber);\n    if (typeof this.gestures[type].defaultOptions === \"function\") {\n      defaultOptions = this.gestures[type].defaultOptions();\n      defaultOptionsPropertyDescriptors = getOwnPropertyDescriptors(defaultOptions);\n    }\n    defaultOptions = Object.create(DefaultGestureOptions, defaultOptionsPropertyDescriptors);\n    const optionsPropertyDescriptors = getOwnPropertyDescriptors(subscriber.options);\n    subscriber.options = Object.create(defaultOptions, optionsPropertyDescriptors);\n    let gesture = new this.gestures[type](subscriber, element);\n    return gesture;\n  }\n}\n"]}