{"version":3,"sources":["../../src/sortable.js"],"names":[],"mappings":"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","file":"sortable.js","sourcesContent":["import {DOM} from \"aurelia-pal\";\nimport {customAttribute, bindable} from \"aurelia-templating\";\nimport {inject, transient} from \"aurelia-dependency-injection\";\nimport {oribella, matchesSelector, STRATEGY_FLAG} from \"oribella-default-gestures\";\nimport {Drag} from \"./drag\";\nimport {AutoScroll} from \"./auto-scroll\";\n\nconst SORTABLE_ITEM = \"oa-sortable-item\";\n\n@customAttribute(\"oa-sortable\")\n@inject(DOM.Element, Drag, AutoScroll)\n@transient()\nexport class Sortable {\n\n  @bindable scroll = null;\n  @bindable scrollSpeed = 10;\n  @bindable scrollSensitivity = 10;\n  @bindable items = [];\n  @bindable sortingClass = \"oa-sorting\";\n  @bindable draggingClass = \"oa-dragging\";\n  @bindable axis = \"\";\n  @bindable moved = () => {};\n  @bindable dragZIndex = 1;\n  @bindable disallowedDragTagNames = [\"INPUT\", \"SELECT\", \"TEXTAREA\"];\n  @bindable allowDrag = args => {\n    if (this.disallowedDragTagNames.indexOf(args.event.target.tagName) !== -1) {\n      return false;\n    }\n    if (args.event.target.isContentEditable) {\n      return false;\n    }\n    return true;\n  };\n  @bindable allowMove = () => { return true; };\n\n  selector = \"[\" + SORTABLE_ITEM + \"]\";\n  fromIx = -1;\n  toIx = -1;\n  x = 0;\n  y = 0;\n  lastElementFromPointRect = null;\n\n  constructor(element, drag, autoScroll) {\n    this.element = element;\n    this.drag = drag;\n    this.autoScroll = autoScroll;\n    this.options = {\n      strategy: STRATEGY_FLAG.REMOVE_IF_POINTERS_GT\n    };\n  }\n  activate() {\n    this.removeListener = oribella.on(this.element, \"swipe\", this);\n    let scroll = this.scroll;\n    if (typeof scroll === \"string\") {\n      if (scroll === \"document\") {\n        this.scroll = document.scrollingElement || document.documentElement || document.body;\n        this.viewportScroll = true;\n        this.removeScroll = this.bindScroll(document, this.onScroll.bind(this));\n        return;\n      } else {\n        scroll = this.closest(this.element, scroll);\n      }\n    }\n    this.scroll = scroll;\n    if (!(this.scroll instanceof DOM.Element)) {\n      this.scroll = this.element;\n    }\n    this.removeScroll = this.bindScroll(this.scroll, this.onScroll.bind(this));\n  }\n  deactivate() {\n    if (typeof this.removeListener === \"function\") {\n      this.removeListener();\n    }\n    if (typeof this.removeScroll === \"function\") {\n      this.removeScroll();\n    }\n  }\n  attached() {\n    this.activate();\n  }\n  detached() {\n    this.deactivate();\n  }\n  bindScroll(scroll, fn) {\n    scroll.addEventListener(\"scroll\", fn, false);\n    return () => {\n      scroll.removeEventListener(\"scroll\", fn, false);\n    };\n  }\n  onScroll() {\n    if (!this.drag.element) {\n      return;\n    }\n    const { scrollLeft, scrollTop } = this.scroll;\n    this.drag.update(this.x,\n      this.y,\n      this.viewportScroll,\n      scrollLeft,\n      scrollTop,\n      this.axis,\n      this.dragMinPosX,\n      this.dragMaxPosX,\n      this.dragMinPosY,\n      this.dragMaxPosY);\n    const { x, y } = this.getPoint(this.x, this.y);\n    this.tryMove(x, y, scrollLeft, scrollTop);\n  }\n  getScrollFrames(maxPos, scrollPos) {\n    return Math.max(0, Math.ceil(Math.abs(maxPos - scrollPos) / this.scrollSpeed));\n  }\n  getScrollDirectionX(x, { left, right }) {\n    let dir = 0;\n    switch (this.axis) {\n      default:\n      case \"x\":\n      if (x >= right - this.scrollSensitivity) {\n        dir = 1;\n      } else if (x <= left + this.scrollSensitivity) {\n        dir = -1;\n      }\n      break;\n    }\n    return dir;\n  }\n  getScrollDirectionY(y, { top, bottom }) {\n    let dir = 0;\n    switch (this.axis) {\n      default:\n      case \"y\":\n      if (y >= bottom - this.scrollSensitivity) {\n        dir = 1;\n      } else if (y <= top + this.scrollSensitivity) {\n        dir = -1;\n      }\n      break;\n    }\n    return dir;\n  }\n  hide(element) {\n    const display = element.style.display;\n    element.style.display = \"none\";\n    return () => {\n      element.style.display = display;\n    };\n  }\n  closest(element, selector, rootElement = document) {\n    var valid = false;\n    while (!valid && element !== null && element !== rootElement &&\n      element !== document) {\n      valid = matchesSelector(element, selector);\n      if (valid) {\n        break;\n      }\n      element = element.parentNode;\n    }\n    return valid ? element : null;\n  }\n  getItemViewModel(element) {\n    return element.au[SORTABLE_ITEM].viewModel;\n  }\n  moveSortingItem(toIx) {\n    const fromIx = this.items.indexOf(this.drag.item);\n    this.move(fromIx, toIx);\n  }\n  move(fromIx, toIx) {\n    if (fromIx !== -1 && toIx !== -1 && fromIx !== toIx) {\n      this.items.splice(toIx, 0, this.items.splice(fromIx, 1)[0]);\n    }\n  }\n  tryUpdate(x, y, offsetX, offsetY) {\n    const showFn = this.hide(this.drag.clone);\n    this.tryMove(x, y, offsetX, offsetY);\n    showFn();\n  }\n  pointInside(x, y, rect) {\n    return x >= rect.left &&\n      x <= rect.right &&\n      y >= rect.top &&\n      y <= rect.bottom;\n  }\n  elementFromPoint(x, y) {\n    let element = document.elementFromPoint(x, y);\n    if (!element) {\n      return null;\n    }\n    element = this.closest(element, this.selector, this.element);\n    if (!element) {\n      return null;\n    }\n    return element;\n  }\n  canThrottle(x, y, offsetX, offsetY) {\n    return this.lastElementFromPointRect &&\n      this.pointInside(x + offsetX, y + offsetY, this.lastElementFromPointRect);\n  }\n  tryMove(x, y, offsetX, offsetY) {\n    if (this.canThrottle(x, y, offsetX, offsetY)) {\n      return;\n    }\n    const element = this.elementFromPoint(x, y);\n    if (!element) {\n      return;\n    }\n    const vm = this.getItemViewModel(element);\n    this.lastElementFromPointRect = element.getBoundingClientRect();\n    if (!this.allowMove({ item: vm.item })) {\n      return;\n    }\n    this.moveSortingItem(vm.ctx.$index);\n  }\n  getPoint(pageX, pageY) {\n    switch (this.axis) {\n    case \"x\":\n      pageY = this.drag.getCenterY();\n      break;\n    case \"y\":\n      pageX = this.drag.getCenterX();\n      break;\n    default:\n      break;\n    }\n    return {\n      x: pageX,\n      y: pageY\n    };\n  }\n  down(e, data, element) {\n    if (this.allowDrag({ event: e, item: this.getItemViewModel(element).item })) {\n      e.preventDefault();\n      return undefined;\n    }\n    return false;\n  }\n  start(e, data, element) {\n    const { scrollLeft, scrollTop } = this.scroll;\n\n    this.windowHeight = innerHeight;\n    this.windowWidth = innerWidth;\n    this.x = data.pointers[0].client.x;\n    this.y = data.pointers[0].client.y;\n    this.sortableRect = this.element.getBoundingClientRect();\n\n    this.scrollRect = this.scroll.getBoundingClientRect();\n    this.scrollWidth = this.scroll.scrollWidth;\n    this.scrollHeight = this.scroll.scrollHeight;\n\n    this.boundingRect = {\n      left: Math.max(0, this.sortableRect.left),\n      top: Math.max(0, this.sortableRect.top),\n      bottom: Math.min(this.windowHeight, this.sortableRect.bottom),\n      right: Math.min(this.windowWidth, this.sortableRect.right)\n    };\n\n    this.sortableContainsScroll = this.element.contains(this.scroll);\n    if (this.sortableContainsScroll) {\n      this.scrollMaxPosX = this.scrollWidth - this.scrollRect.width;\n      this.scrollMaxPosY = this.scrollHeight - this.scrollRect.height;\n      this.dragMinPosX = this.sortableRect.left;\n      this.dragMaxPosX = this.sortableRect.left + this.scrollWidth;\n      this.dragMaxPosY = this.sortableRect.top + this.scrollHeight;\n      this.dragMinPosY = this.sortableRect.top;\n    } else {\n      this.scrollMaxPosX = this.sortableRect.right - this.windowWidth + (this.viewportScroll ? scrollLeft : 0);\n      this.scrollMaxPosY = this.sortableRect.bottom - this.windowHeight + (this.viewportScroll ? scrollTop : 0);\n      this.dragMinPosX = this.sortableRect.left + scrollLeft;\n      this.dragMaxPosX = this.scrollMaxPosX + this.windowWidth;\n      this.dragMinPosY = this.sortableRect.top + scrollTop;\n      this.dragMaxPosY = this.scrollMaxPosY + this.windowHeight;\n    }\n\n    this.sortingViewModel = this.getItemViewModel(element);\n    this.fromIx = this.sortingViewModel.ctx.$index;\n    this.toIx = -1;\n\n    this.drag.start( element,\n      this.sortingViewModel.item,\n      this.x, this.y,\n      this.viewportScroll,\n      scrollLeft,\n      scrollTop,\n      this.dragZIndex,\n      this.axis, this.sortingClass,\n      this.dragMinPosX,\n      this.dragMaxPosX,\n      this.dragMinPosY,\n      this.dragMaxPosY);\n    this.autoScroll.start(this.scrollSpeed);\n    this.lastElementFromPointRect = this.drag.rect;\n  }\n  update(e, data) {\n    const p = data.pointers[0].client;\n    const { scrollLeft, scrollTop } = this.scroll;\n    this.x = p.x;\n    this.y = p.y;\n    this.drag.update(this.x,\n      this.y,\n      this.viewportScroll,\n      scrollLeft,\n      scrollTop,\n      this.axis,\n      this.dragMinPosX,\n      this.dragMaxPosX,\n      this.dragMinPosY,\n      this.dragMaxPosY);\n    const { x, y } = this.getPoint(p.x, p.y);\n    const scrollX = this.autoScroll.active ? scrollLeft : 0;\n    const scrollY = this.autoScroll.active ? scrollTop : 0;\n    this.tryUpdate(x, y, scrollX, scrollY);\n\n    const dirX = this.getScrollDirectionX(x, this.boundingRect);\n    const dirY = this.getScrollDirectionY(y, this.boundingRect);\n    let frameCntX = this.getScrollFrames(dirX === -1 ? 0 : this.scrollMaxPosX, scrollLeft);\n    let frameCntY = this.getScrollFrames(dirY === -1 ? 0 : this.scrollMaxPosY, scrollTop);\n    if ((dirX === 1 && scrollLeft >= this.scrollMaxPosX) ||\n      (dirX === -1 && scrollLeft === 0)) {\n      frameCntX = 0;\n    }\n    if ((dirY === 1 && scrollTop >= this.scrollMaxPosY) ||\n      (dirY === -1 && scrollTop === 0)) {\n      frameCntY = 0;\n    }\n    this.autoScroll.update(this.scroll, dirX, dirY, frameCntX, frameCntY);\n  }\n  end() {\n    if (!this.drag.item) {\n      return; //cancelled\n    }\n    this.stop();\n    if (this.fromIx !== this.toIx) {\n      this.moved( { fromIx: this.fromIx, toIx: this.toIx } );\n    }\n  }\n  cancel() {\n    this.move(this.sortingViewModel.ctx.$index, this.fromIx);\n    this.stop();\n  }\n  stop() {\n    this.drag.end();\n    this.autoScroll.end();\n  }\n}\n\n@customAttribute(\"oa-sortable-item\")\nexport class SortableItem {\n\n  @bindable item = null;\n\n  bind(ctx, overrideCtx) {\n    this.ctx = overrideCtx; //Need a reference to the item's $index\n  }\n}\n"]}